{"version":3,"sources":["../src/create_controls.js"],"names":["window","onload","history","forward","addSpinners","distribution","created","Log","debug","spinnerForGroupDistribution","spinnerForGroupingDistribution","spinnerForGroupGroupingCopy","spinnerForStdDistribution","beforeunloadHandler","addEventListener","event","preventDefault","find","each","addClass","gid","attr","statuscol","html","children","e","init","StudentCopyControls"],"mappings":"yfA6BA,uDACA,OACA,O,siBAGAA,MAAM,CAACC,MAAP,CAAgBD,MAAM,CAACE,OAAP,CAAeC,OAAf,EAAhB,C,GAEMC,CAAAA,CAAW,CAAG,SAACC,CAAD,CAAeC,CAAf,CAA2B,CAC7CC,CAAG,CAACC,KAAJ,CAAU,oBAAV,EACAD,CAAG,CAACC,KAAJ,CAAUH,CAAV,EAEA,GAAoB,uBAAhB,EAAAA,CAAY,EAA+C,YAAhB,EAAAA,CAA/C,CAA6E,CAC3EI,CAA2B,EAC5B,CAFD,IAEO,IACW,0BAAhB,EAAAJ,CAAY,EACI,eAAhB,EAAAA,CAFK,CAGL,CACAK,CAA8B,CAACJ,CAAD,CAC/B,CALM,IAKA,IAAoB,qBAAhB,EAAAD,CAAJ,CAA2C,CAChDM,CAA2B,EAC5B,CAFM,IAEA,CACLC,CAAyB,EAC1B,CACF,C,CAEKC,CAAmB,CAAG,UAAM,CAChCb,MAAM,CAACc,gBAAP,CAAwB,cAAxB,CAAwC,SAACC,CAAD,CAAW,CACjDA,CAAK,CAACC,cAAN,EACD,CAFD,CAGD,C,CAEKP,CAA2B,CAAG,UAAM,CACxC,cAAE,OAAF,EACGQ,IADH,CACQ,mBADR,EAEGC,IAFH,CAEQ,UAAY,CAChB,cAAE,gBAAF,EAAoBC,QAApB,CAA6B,sBAA7B,CACD,CAJH,CAKD,C,CAEKT,CAA8B,CAAG,SAACJ,CAAD,CAAa,CAClD,cAAE,OAAF,EACGW,IADH,CACQ,sBADR,EAEGC,IAFH,CAEQ,UAAY,IACZE,CAAAA,CAAG,CAAG,cAAE,IAAF,EAAQC,IAAR,CAAa,kBAAb,CADM,CAEZC,CAAS,CAAG,cAAE,IAAF,EAAQL,IAAR,CAAa,kBAAoBG,CAAjC,CAFA,CAGhB,GAAId,CAAJ,CAAa,CACX,cAAEgB,CAAF,EAAaC,IAAb,CAAkB,SAAlB,EACA,cAAED,CAAF,EAAaH,QAAb,CAAsB,eAAtB,CACD,CAHD,IAGO,CACL,cAAE,kBAAoBC,CAAtB,EAA2BD,QAA3B,CAAoC,sBAApC,CACD,CACF,CAXH,CAYD,C,CAEKR,CAA2B,CAAG,SAACL,CAAD,CAAa,CAC/C,cAAE,OAAF,EACGW,IADH,CACQ,eADR,EAEGC,IAFH,CAEQ,UAAY,IACZE,CAAAA,CAAG,CAAG,cAAE,IAAF,EAAQC,IAAR,CAAa,WAAb,CADM,CAEZC,CAAS,CAAG,cAAE,IAAF,EAAQL,IAAR,CAAa,kBAAoBG,CAAjC,CAFA,CAGhB,GAAId,CAAJ,CAAa,CACX,cAAEgB,CAAF,EAAaC,IAAb,CAAkB,SAAlB,EACA,cAAED,CAAF,EAAaH,QAAb,CAAsB,eAAtB,CACD,CAHD,IAGO,CACL,cAAE,kBAAoBC,CAAtB,EAA2BD,QAA3B,CAAoC,sBAApC,CACD,CACF,CAXH,CAYD,C,CAEKP,CAAyB,CAAG,UAAM,CACtC,cAAE,OAAF,EACGY,QADH,GAEGN,IAFH,CAEQ,SAAUO,CAAV,CAAa,CACjB,cAAE,SAAWA,CAAb,EAAgBN,QAAhB,CAAyB,sBAAzB,CACD,CAJH,CAKD,C,CAEYO,CAAI,CAAG,SAACpB,CAAD,CAAUD,CAAV,CAA2B,CAC7CE,CAAG,CAACC,KAAJ,CAAU,yDAAV,EACAD,CAAG,CAACC,KAAJ,CAAUH,CAAV,CAAwBC,CAAxB,EAGA,GAAI,CAACA,CAAL,CAAc,CACZO,CAAmB,GACnBT,CAAW,CAACC,CAAD,CAAeC,CAAf,CAAX,CAEAqB,CAAmB,CAACD,IAApB,CAAyBrB,CAAzB,CACD,CACF,C","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Provides the mod_googleactivity/created_control module\n *\n * @package   mod_googleactivity\n * @category  output\n * @copyright 2021 Veronica Bermegui\n * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\n/**\n * @module mod_googleactivity/controls\n *\n */\n\nimport $ from \"jquery\";\nimport * as Log from \"core/log\";\nimport * as StudentCopyControls from \"mod_googleactivity/student_copy_controls\";\n\n// Prevent user from going backwards.\nwindow.onload = window.history.forward();\n\nconst addSpinners = (distribution, created) => {\n  Log.debug(\"Adding spinners...\");\n  Log.debug(distribution);\n\n  if (distribution == \"dist_share_same_group\" || distribution == \"group_copy\") {\n    spinnerForGroupDistribution();\n  } else if (\n    distribution == \"dist_share_same_grouping\" ||\n    distribution == \"grouping_copy\"\n  ) {\n    spinnerForGroupingDistribution(created);\n  } else if (distribution == \"group_grouping_copy\") {\n    spinnerForGroupGroupingCopy();\n  } else {\n    spinnerForStdDistribution();\n  }\n};\n\nconst beforeunloadHandler = () => {\n  window.addEventListener(\"beforeunload\", (event) => {\n    event.preventDefault();\n  });\n};\n\nconst spinnerForGroupDistribution = () => {\n  $(\"tbody\")\n    .find(\"[data-group-name]\")\n    .each(function () {\n      $(\"div#status_col\").addClass(\"spinner-border color\");\n    });\n};\n\nconst spinnerForGroupingDistribution = (created) => {\n  $(\"tbody\")\n    .find(\"[data-grouping-name]\")\n    .each(function () {\n      var gid = $(this).attr(\"data-grouping-id\");\n      var statuscol = $(this).find(\"div#status_col_\" + gid);\n      if (created) {\n        $(statuscol).html(\"Created\");\n        $(statuscol).addClass(\"status-access\");\n      } else {\n        $(\"div#status_col_\" + gid).addClass(\"spinner-border color\");\n      }\n    });\n};\n\nconst spinnerForGroupGroupingCopy = (created) => {\n  $(\"tbody\")\n    .find(\"[data-g-name]\")\n    .each(function () {\n      var gid = $(this).attr(\"data-g-id\");\n      var statuscol = $(this).find(\"div#status_col_\" + gid);\n      if (created) {\n        $(statuscol).html(\"Created\");\n        $(statuscol).addClass(\"status-access\");\n      } else {\n        $(\"div#status_col_\" + gid).addClass(\"spinner-border color\");\n      }\n    });\n};\n\nconst spinnerForStdDistribution = () => {\n  $(\"tbody\")\n    .children()\n    .each(function (e) {\n      $(\"#file_\" + e).addClass(\"spinner-border color\");\n    });\n};\n\nexport const init = (created, distribution) => {\n  Log.debug(\"mod_googleactivity: initializing mod_googledocs control\");\n  Log.debug(distribution, created);\n\n  // Its not created. Add spinners and block events.\n  if (!created) {\n    beforeunloadHandler();\n    addSpinners(distribution, created);\n\n    StudentCopyControls.init(distribution);\n  }\n};\n"],"file":"create_controls.min.js"}