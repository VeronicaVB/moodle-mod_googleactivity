function _typeof(a){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){_typeof=function(a){return typeof a}}else{_typeof=function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a}}return _typeof(a)}define ("mod_googleactivity/student_copy_controls",["exports","jquery","core/log","core/ajax"],function(a,b,c,d){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.init=void 0;b=g(b);c=f(c);d=g(d);function e(){if("function"!=typeof WeakMap)return null;var a=new WeakMap;e=function(){return a};return a}function f(a){if(a&&a.__esModule){return a}if(null===a||"object"!==_typeof(a)&&"function"!=typeof a){return{default:a}}var b=e();if(b&&b.has(a)){return b.get(a)}var c={},d=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var f in a){if(Object.prototype.hasOwnProperty.call(a,f)){var g=d?Object.getOwnPropertyDescriptor(a,f):null;if(g&&(g.get||g.set)){Object.defineProperty(c,f,g)}else{c[f]=a[f]}}}c.default=a;if(b){b.set(a,c)}return c}function g(a){return a&&a.__esModule?a:{default:a}}var h=function(){c.debug("Collecting students details ...");var a=[];(0,b.default)("tbody").children().each(function(){var c=(0,b.default)(this).attr("data-student-id"),d=(0,b.default)(this).attr("data-student-email"),e=(0,b.default)(this).attr("student-name");if(c&&d&&e){a.push({studentId:c,studentEmail:d,studentName:e})}});return a},i=function(a){c.debug("In createStudentFileCopyService...");d.default.call([{methodname:"mod_googleactivity_create_students_files",args:{students:JSON.stringify(h()),instanceid:(0,b.default)("table.overviewTable").attr("data-instance-id")},done:function done(b){var c=JSON.parse(b.records);j(c,a)},fail:function fail(a){c.error(a)}}])},j=function(a,b){if("group_copy"==b||"dist_share_same_group"==b){m(a,b)}if("std_copy"==b||"dist_share_same"==b){k(a)}if("std_copy_group"==b||"std_copy_grouping"==b||"std_copy_group_grouping"==b){l(a)}if("dist_share_same_grouping"==b){n(a)}if("group_grouping_copy"==b||"dist_share_same_group_grouping"==b){o(a)}},k=function(a){c.debug("Rendering results ...");var b,d=document.querySelectorAll("#table-body tr"),e=function(){var c=d[b].getAttribute("data-student-id"),e=a.find(function(a){return a.userid==c});d[b].querySelector("#link_file_"+b).href=e.url;d[b].querySelector("#file_"+b).classList.remove("spinner-border");d[b].querySelector("#file_"+b).innerText="Created"};for(b=0;b<d.length;b++){e()}},l=function(a){c.debug("In renderCopyGroup...");a=a.reduce(function(c,a){return c.concat(a)},[]);var b,d=document.querySelectorAll("#table-body tr"),e=function(){var c=d[b].getAttribute("data-student-id"),e=a.find(function(a){return a.userid==c});d[b].querySelector("#link_file_"+b).href=e.url;d[b].querySelector("#file_"+b).classList.remove("spinner-border");d[b].querySelector("#file_"+b).innerText="Created"};for(b=0;b<d.length;b++){e()}},m=function(a){c.debug("In renderShareSameGroup...");a=a.reduce(function(c,a){return c.concat(a)},[]);var b,d=document.querySelectorAll("#table-body tr");for(b=0;b<d.length;b++){if(d[b].hasAttribute("id")){(function(){var c=d[b].getAttribute("data-group-id"),e=a.find(function(a){return a.groupid==c});d[b].querySelector("#shared_link_url_"+e.groupid).href=e.url;d[b].querySelector("#status_col").classList.remove("spinner-border");d[b].querySelector("#status_col").innerText="Created"})()}}},n=function(a){c.debug("In renderShareSameGrouping...");a=a.reduce(function(c,a){return c.concat(a)},[]);c.debug(a);var b,d=document.querySelectorAll("#table-body tr");for(b=0;b<d.length;b++){if(d[b].hasAttribute("id")){(function(){var c=d[b].getAttribute("data-grouping-id"),e=a.find(function(a){return a.groupingid==c});d[b].querySelector("#shared_link_url_"+e.groupingid).href=e.url;d[b].querySelector("#status_col_"+c).classList.remove("spinner-border");d[b].querySelector("#status_col_"+c).innerText="Created"})()}}},o=function(a){c.debug("In renderGroupGroupingCopy...");a=a.reduce(function(c,a){return c.concat(a)},[]);c.debug(a);var b,d=document.querySelectorAll("#table-body tr");for(b=0;b<d.length;b++){if(d[b].hasAttribute("id")){(function(){var c=d[b].getAttribute("data-g-id"),e=d[b].getAttribute("data-g-type"),f=void 0;if("grouping"==e){f=a.find(function(a){return a.groupingid==c});d[b].querySelector("#shared_link_url_"+f.groupingid).href=f.url}else{f=a.find(function(a){return a.groupid==c});d[b].querySelector("#shared_link_url_"+f.groupid).href=f.url}d[b].querySelector("#status_col_"+c).classList.remove("spinner-border");d[b].querySelector("#status_col_"+c).innerText="Created"})()}}};a.init=function init(a){i(a)}});
//# sourceMappingURL=student_copy_controls.min.js.map
